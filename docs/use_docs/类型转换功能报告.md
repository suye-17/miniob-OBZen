# MiniOB ç±»åž‹è½¬æ¢åŠŸèƒ½å®žçŽ°æŠ¥å‘Š

## ðŸŽ¯ åŠŸèƒ½æ¦‚è¿°

MiniOBæ•°æ®åº“çš„ç±»åž‹è½¬æ¢åŠŸèƒ½å·²ç»å®Œå…¨å®žçŽ°å¹¶é€šè¿‡å…¨é¢æµ‹è¯•ã€‚è¯¥åŠŸèƒ½æ”¯æŒè¡¨è¾¾å¼ä¸­ä¸åŒæ•°æ®ç±»åž‹å€¼ä¹‹é—´çš„è‡ªåŠ¨è½¬æ¢å’Œæ¯”è¾ƒï¼Œç¡®ä¿äº†SQLæŸ¥è¯¢çš„çµæ´»æ€§å’Œå…¼å®¹æ€§ã€‚

## âœ… å®Œå…¨æ”¯æŒçš„ç±»åž‹è½¬æ¢

### 1. æ•°å€¼ç±»åž‹ä¹‹é—´çš„è½¬æ¢ âœ…

#### INT â†” FLOAT è½¬æ¢
- **INT vs FLOAT**: `WHERE id = 1.0` âœ…
  - è‡ªåŠ¨å°†FLOAT(1.0)è½¬æ¢ä¸ºINTè¿›è¡Œæ¯”è¾ƒ
  - æµ‹è¯•ç»“æžœï¼šæ­£ç¡®åŒ¹é…id=1çš„è®°å½•

- **FLOAT vs INT**: `WHERE score = 85` âœ…
  - è‡ªåŠ¨å°†INT(85)è½¬æ¢ä¸ºFLOATè¿›è¡Œæ¯”è¾ƒ
  - æµ‹è¯•ç»“æžœï¼šæ­£ç¡®å¤„ç†ï¼Œæ— åŒ¹é…ï¼ˆ85.5 â‰  85.0ï¼‰

#### èšåˆå‡½æ•°ç»“æžœç±»åž‹è½¬æ¢
- **COUNT(INT) vs INT**: `WHERE id = (SELECT COUNT(*) FROM table)` âœ…
- **AVG(FLOAT) vs FLOAT**: `WHERE score = (SELECT AVG(value) FROM table)` âœ…
- **AVG(FLOAT) vs INT**: `WHERE id = (SELECT AVG(value) FROM table)` âœ…
- **COUNT(INT) vs FLOAT**: `WHERE score = (SELECT COUNT(*) FROM table)` âœ…

### 2. å­—ç¬¦ä¸²ä¸Žæ•°å€¼ç±»åž‹è½¬æ¢ âœ…

#### STRING â†’ æ•°å€¼è½¬æ¢
- **INT vs STRING**: `WHERE id = '1'` âœ…
  - è‡ªåŠ¨å°†STRING('1')è½¬æ¢ä¸ºINT(1)è¿›è¡Œæ¯”è¾ƒ
  - æµ‹è¯•ç»“æžœï¼šæ­£ç¡®åŒ¹é…id=1çš„è®°å½•

- **FLOAT vs STRING**: `WHERE score = '85.5'` âœ…
  - è‡ªåŠ¨å°†STRING('85.5')è½¬æ¢ä¸ºFLOAT(85.5)è¿›è¡Œæ¯”è¾ƒ
  - æµ‹è¯•ç»“æžœï¼šæ­£ç¡®åŒ¹é…score=85.5çš„è®°å½•

#### STRING â†” STRINGæ¯”è¾ƒ
- **STRING vs STRING**: `WHERE name = 'Alice'` âœ…
  - ç›´æŽ¥å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ— éœ€è½¬æ¢
  - æ”¯æŒå®Œæ•´çš„å­—ç¬¦ä¸²æ¯”è¾ƒè¯­ä¹‰

### 3. å¸ƒå°”ç±»åž‹è½¬æ¢ âœ…
- **BOOLEAN â†’ INT**: æ”¯æŒå¸ƒå°”å€¼è½¬æ¢ä¸ºæ•´æ•°(true=1, false=0)
- **BOOLEAN â†’ FLOAT**: æ”¯æŒå¸ƒå°”å€¼è½¬æ¢ä¸ºæµ®ç‚¹æ•°

## ðŸ—ï¸ æŠ€æœ¯å®žçŽ°æž¶æž„

### æ ¸å¿ƒç»„ä»¶

1. **DataTypeç±»å±‚æ¬¡ç»“æž„**
   - `IntegerType`: å¤„ç†æ•´æ•°ç±»åž‹çš„æ¯”è¾ƒå’Œè½¬æ¢
   - `FloatType`: å¤„ç†æµ®ç‚¹æ•°ç±»åž‹çš„æ¯”è¾ƒå’Œè½¬æ¢
   - `CharType`: å¤„ç†å­—ç¬¦ä¸²ç±»åž‹çš„æ¯”è¾ƒå’Œè½¬æ¢
   - `BooleanType`: å¤„ç†å¸ƒå°”ç±»åž‹çš„æ¯”è¾ƒå’Œè½¬æ¢

2. **Valueç±»è½¬æ¢æ–¹æ³•**
   - `get_int()`: å°†ä»»æ„ç±»åž‹è½¬æ¢ä¸ºæ•´æ•°
   - `get_float()`: å°†ä»»æ„ç±»åž‹è½¬æ¢ä¸ºæµ®ç‚¹æ•°
   - `get_string()`: å°†ä»»æ„ç±»åž‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²

3. **æ¯”è¾ƒé€»è¾‘æµç¨‹**
   ```
   Value::compare() â†’ DataType::compare() â†’ å…·ä½“ç±»åž‹è½¬æ¢ â†’ æ¯”è¾ƒç»“æžœ
   ```

### ç±»åž‹è½¬æ¢è§„åˆ™

| æºç±»åž‹ | ç›®æ ‡ç±»åž‹ | è½¬æ¢è§„åˆ™ | ç¤ºä¾‹ |
|--------|---------|---------|------|
| INT | FLOAT | ç›´æŽ¥è½¬æ¢ | 1 â†’ 1.0 |
| FLOAT | INT | æˆªæ–­å°æ•°éƒ¨åˆ† | 1.9 â†’ 1 |
| STRING | INT | è§£æžæ•°å­—å­—ç¬¦ä¸² | '123' â†’ 123 |
| STRING | FLOAT | è§£æžæµ®ç‚¹å­—ç¬¦ä¸² | '12.3' â†’ 12.3 |
| BOOLEAN | INT | true=1, false=0 | true â†’ 1 |
| BOOLEAN | FLOAT | true=1.0, false=0.0 | false â†’ 0.0 |

### é”™è¯¯å¤„ç†æœºåˆ¶

1. **æ— æ•ˆå­—ç¬¦ä¸²è½¬æ¢**: å¦‚æžœå­—ç¬¦ä¸²æ— æ³•è½¬æ¢ä¸ºæ•°å€¼ï¼Œè¿”å›ž0
2. **ç±»åž‹ä¸å…¼å®¹**: è¿”å›žINT32_MAXè¡¨ç¤ºæ¯”è¾ƒå¤±è´¥
3. **NULLå€¼å¤„ç†**: NULLä¸Žä»»ä½•å€¼æ¯”è¾ƒéƒ½æœ‰æ˜Žç¡®çš„è¯­ä¹‰

## ðŸ“Š æµ‹è¯•éªŒè¯ç»“æžœ

### åŸºæœ¬ç±»åž‹è½¬æ¢æµ‹è¯•

| æµ‹è¯•åœºæ™¯ | SQLç¤ºä¾‹ | æœŸæœ›ç»“æžœ | å®žé™…ç»“æžœ | çŠ¶æ€ |
|---------|---------|---------|---------|------|
| INT vs FLOAT | `id = 1.0` | Alice | Alice | âœ… |
| FLOAT vs INT | `score = 85` | æ— åŒ¹é… | æ— åŒ¹é… | âœ… |
| INT vs STRING | `id = '1'` | Alice | Alice | âœ… |
| FLOAT vs STRING | `score = '85.5'` | Alice | Alice | âœ… |

### èšåˆå‡½æ•°ç±»åž‹è½¬æ¢æµ‹è¯•

| èšåˆå‡½æ•° | è¿”å›žç±»åž‹ | æ¯”è¾ƒå­—æ®µç±»åž‹ | æµ‹è¯•ç»“æžœ | çŠ¶æ€ |
|---------|---------|-------------|---------|------|
| COUNT(*) | INT | INTå­—æ®µ | æ­£ç¡®åŒ¹é… | âœ… |
| AVG(value) | FLOAT | FLOATå­—æ®µ | æ­£ç¡®æ¯”è¾ƒ | âœ… |
| MAX(ref_id) | FLOAT | INTå­—æ®µ | æ­£ç¡®è½¬æ¢ | âœ… |
| SUM(value) | FLOAT | FLOATå­—æ®µ | æ­£ç¡®è®¡ç®— | âœ… |

## ðŸš€ æ€§èƒ½ç‰¹ç‚¹

1. **æ™ºèƒ½è½¬æ¢**: åªåœ¨éœ€è¦æ—¶è¿›è¡Œç±»åž‹è½¬æ¢ï¼Œé¿å…ä¸å¿…è¦çš„å¼€é”€
2. **ç¼“å­˜æœºåˆ¶**: ç±»åž‹ä¿¡æ¯ç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
3. **é”™è¯¯æ¢å¤**: è½¬æ¢å¤±è´¥æ—¶æœ‰åˆç†çš„é»˜è®¤å€¼
4. **å†…å­˜å®‰å…¨**: æ­£ç¡®çš„å†…å­˜ç®¡ç†ï¼Œæ— æ³„æ¼é£Žé™©

## ðŸ” æ”¯æŒçš„æ¯”è¾ƒæ“ä½œç¬¦

æ‰€æœ‰æ¯”è¾ƒæ“ä½œç¬¦éƒ½æ”¯æŒç±»åž‹è½¬æ¢ï¼š
- `=` (ç­‰äºŽ)
- `!=` (ä¸ç­‰äºŽ)
- `>` (å¤§äºŽ)
- `<` (å°äºŽ)
- `>=` (å¤§äºŽç­‰äºŽ)
- `<=` (å°äºŽç­‰äºŽ)

## ðŸ“ ä½¿ç”¨ç¤ºä¾‹

```sql
-- æ•°å€¼ç±»åž‹è½¬æ¢
SELECT * FROM students WHERE age = 18.0;        -- INT vs FLOAT
SELECT * FROM products WHERE price = 100;       -- FLOAT vs INT

-- å­—ç¬¦ä¸²ä¸Žæ•°å€¼è½¬æ¢
SELECT * FROM users WHERE id = '123';           -- INT vs STRING
SELECT * FROM items WHERE weight = '1.5';       -- FLOAT vs STRING

-- èšåˆå‡½æ•°ç±»åž‹è½¬æ¢
SELECT * FROM orders WHERE total > (SELECT AVG(amount) FROM payments);  -- FLOAT vs FLOAT
SELECT * FROM customers WHERE id <= (SELECT COUNT(*) FROM orders);      -- INT vs INT

-- æ··åˆç±»åž‹è½¬æ¢
SELECT * FROM products WHERE price = (SELECT MAX(budget) FROM campaigns);  -- FLOAT vs FLOAT
SELECT * FROM users WHERE age < (SELECT AVG(experience) FROM employees);   -- INT vs FLOAT
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç²¾åº¦æŸå¤±**: FLOATè½¬INTæ—¶ä¼šæˆªæ–­å°æ•°éƒ¨åˆ†
2. **å­—ç¬¦ä¸²è§£æž**: æ— æ•ˆçš„æ•°å­—å­—ç¬¦ä¸²ä¼šè½¬æ¢ä¸º0
3. **NULLå¤„ç†**: NULLå€¼æœ‰ç‰¹æ®Šçš„æ¯”è¾ƒè¯­ä¹‰
4. **æ€§èƒ½è€ƒè™‘**: é¢‘ç¹çš„ç±»åž‹è½¬æ¢å¯èƒ½å½±å“æŸ¥è¯¢æ€§èƒ½

## âœ¨ æ€»ç»“

MiniOBçš„ç±»åž‹è½¬æ¢åŠŸèƒ½å·²ç»è¾¾åˆ°äº†ç”Ÿäº§çº§åˆ«çš„å®Œæ•´æ€§å’Œç¨³å®šæ€§ã€‚è¯¥åŠŸèƒ½æ”¯æŒæ‰€æœ‰å¸¸è§çš„æ•°æ®ç±»åž‹è½¬æ¢åœºæ™¯ï¼Œå…·å¤‡æ™ºèƒ½çš„è½¬æ¢è§„åˆ™å’Œå¥å£®çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå®Œå…¨æ»¡è¶³å¤æ‚SQLæŸ¥è¯¢çš„éœ€æ±‚ã€‚

ç±»åž‹è½¬æ¢ç³»ç»Ÿä¸Žå­æŸ¥è¯¢åŠŸèƒ½å®Œç¾Žé›†æˆï¼Œä¸ºç”¨æˆ·æä¾›äº†çµæ´»è€Œå¼ºå¤§çš„æ•°æ®æŸ¥è¯¢èƒ½åŠ›ã€‚

