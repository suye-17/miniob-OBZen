=== 标量子查询多列检查专项测试 ===

=== 初始化数据 ===
CREATE TABLE S1(ID INT, VAL INT);
SUCCESS
CREATE TABLE S2(ID INT, COL1 INT, COL2 INT, COL3 CHAR(10));
SUCCESS

INSERT INTO S1 VALUES (1, 100);
SUCCESS
INSERT INTO S1 VALUES (2, 200);
SUCCESS

INSERT INTO S2 VALUES (1, 10, 20, 'A');
SUCCESS
INSERT INTO S2 VALUES (2, 30, 40, 'B');
SUCCESS

=== 测试1: 正确的标量子查询 - 单列 ===
SELECT * FROM S1 WHERE VAL > (SELECT COL1 FROM S2 WHERE ID = 1);
ID | VAL
1 | 100
2 | 200

=== 测试2: 错误 - 标量子查询SELECT * (多列) ===
SELECT * FROM S1 WHERE VAL = (SELECT * FROM S2 WHERE ID = 1);
FAILURE

=== 测试3: 错误 - 标量子查询显式多列 ===
SELECT * FROM S1 WHERE VAL = (SELECT COL1, COL2 FROM S2 WHERE ID = 1);
FAILURE

=== 测试4: 错误 - 比较运算符 > 与多列 ===
SELECT * FROM S1 WHERE VAL > (SELECT COL1, COL2, COL3 FROM S2 WHERE ID = 1);
FAILURE

=== 测试5: 错误 - 比较运算符 < 与多列 ===
SELECT * FROM S1 WHERE VAL < (SELECT * FROM S2 WHERE ID = 2);
FAILURE

=== 测试6: 正确 - 聚合函数单列 ===
SELECT * FROM S1 WHERE VAL > (SELECT AVG(COL1) FROM S2);
ID | VAL
1 | 100
2 | 200

=== 清理 ===
DROP TABLE S1;
SUCCESS
DROP TABLE S2;
SUCCESS
