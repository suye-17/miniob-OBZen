=== IN子查询错误场景测试 ===

=== 初始化测试数据 ===
CREATE TABLE TEST_A(ID INT, VAL INT);
SUCCESS
CREATE TABLE TEST_B(ID INT, COL1 INT, COL2 INT);
SUCCESS

INSERT INTO TEST_A VALUES (1, 10);
SUCCESS
INSERT INTO TEST_A VALUES (2, 20);
SUCCESS
INSERT INTO TEST_A VALUES (3, 30);
SUCCESS

INSERT INTO TEST_B VALUES (1, 10, 100);
SUCCESS
INSERT INTO TEST_B VALUES (2, 20, 200);
SUCCESS

=== 测试1: 正确的IN子查询 - 单列 ===
SELECT * FROM TEST_A WHERE VAL IN (SELECT COL1 FROM TEST_B);
1 | 10
2 | 20
ID | VAL

=== 测试2: 错误 - IN子查询返回多列(SELECT *) ===
SELECT * FROM TEST_A WHERE VAL IN (SELECT * FROM TEST_B);
FAILURE

=== 测试3: 错误 - IN子查询返回多列(显式) ===
SELECT * FROM TEST_A WHERE VAL IN (SELECT ID, COL1 FROM TEST_B);
FAILURE

=== 测试4: 正确的比较 - 标量子查询单列 ===
SELECT * FROM TEST_A WHERE VAL = (SELECT COL1 FROM TEST_B WHERE ID = 1);
ID | VAL
1 | 10

=== 测试5: 错误 - 比较运算符与多列 ===
SELECT * FROM TEST_A WHERE VAL = (SELECT * FROM TEST_B WHERE ID = 1);
ID | VAL

=== 清理 ===
DROP TABLE TEST_A;
SUCCESS
DROP TABLE TEST_B;
SUCCESS

